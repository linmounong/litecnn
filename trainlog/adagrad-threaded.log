c++ -std=c++11 -march=native -O3 -pthread  -I third_party/mnist/include -o bin/mnist_main src/mnist_main.cc layers.o ndarray.o loss.o cnn.o
bin/mnist_main
loaded 60000 from dataset.training_images
loaded 10000 from dataset.test_images
warming up...
0x7fff954b2380 iter:1 epoch:1 loss:4.77707
0x7fff954b2380 iter:2 epoch:1 loss:4.00265
0x7fff954b2380 iter:3 epoch:1 loss:3.16431
0x7fff954b2380 iter:4 epoch:1 loss:2.76238
0x7fff954b2380 iter:5 epoch:1 loss:2.28465
0x7fff954b2380 iter:6 epoch:1 loss:2.05026
0x7fff954b2380 iter:7 epoch:1 loss:3.2034
0x7fff954b2380 iter:8 epoch:1 loss:2.38663
thread thread thread 132thread (((00x7000050c60000x7000051cc0000x700005149000() starting... from ) starting... from ) starting... from 0x700005043000150004500030000) starting... from  count  count  count 0150001500015000 count 


15000
0x700005149000 iter:10 epoch:1 loss:2.00615
0x700005043000 iter:20 epoch:1 loss:2.50862
0x7000051cc000 iter:30 epoch:1 loss:1.62888
0x7000050c6000 iter:40 epoch:1 loss:1.09495
0x700005149000 iter:50 epoch:1 loss:1.24981
0x700005149000 iter:60 epoch:1 loss:0.930502
0x700005149000 iter:70 epoch:1 loss:1.303
0x700005043000 iter:80 epoch:1 loss:0.906675
0x700005149000 iter:90 epoch:1 loss:0.683297
0x700005043000 iter:100 epoch:1 loss:0.770531
0x7000051cc000 iter:110 epoch:1 loss:0.605227
0x700005043000 val_accuracy:0.92
0x700005043000 iter:120 epoch:1 loss:0.594046
0x700005149000 iter:130 epoch:1 loss:0.707273
0x700005043000 iter:140 epoch:1 loss:0.638161
0x700005149000 iter:150 epoch:1 loss:0.502921
0x700005043000 iter:160 epoch:1 loss:0.569402
0x7000050c6000 iter:170 epoch:1 loss:0.509019
0x700005043000 iter:180 epoch:1 loss:0.514432
0x7000050c6000 iter:190 epoch:1 loss:0.464829
0x700005043000 iter:200 epoch:1 loss:0.454061
0x7000051cc000 iter:210 epoch:1 loss:0.452701
0x700005043000 val_accuracy:0.934
0x7000051cc000 iter:220 epoch:1 loss:0.528373
0x700005149000 iter:230 epoch:1 loss:0.505942
0x7000051cc000 iter:240 epoch:1 loss:0.533862
0x700005149000 iter:250 epoch:1 loss:0.517491
0x7000051cc000 iter:260 epoch:1 loss:0.452929
0x700005149000 iter:270 epoch:1 loss:0.625424
0x7000051cc000 iter:280 epoch:1 loss:0.46268
0x700005149000 iter:290 epoch:1 loss:0.583696
0x7000050c6000 iter:300 epoch:1 loss:0.586418
0x7000051cc000 iter:310 epoch:1 loss:0.486485
0x7000050c6000 val_accuracy:0.948
0x7000051cc000 iter:320 epoch:1 loss:0.413946
0x700005043000 iter:330 epoch:1 loss:0.457674
0x7000051cc000 iter:340 epoch:1 loss:0.557727
0x700005043000 iter:350 epoch:1 loss:0.691953
0x700005149000 iter:360 epoch:1 loss:0.549357
0x700005043000 iter:370 epoch:1 loss:0.416155
0x700005149000 iter:380 epoch:1 loss:0.635604
0x7000050c6000 iter:390 epoch:1 loss:0.399677
0x700005149000 iter:400 epoch:1 loss:0.489122
0x7000051cc000 iter:410 epoch:1 loss:0.560313
0x700005149000 val_accuracy:0.945
0x7000051cc000 iter:420 epoch:1 loss:0.485144
0x700005149000 iter:430 epoch:1 loss:0.50868
0x7000051cc000 iter:440 epoch:1 loss:0.511409
0x700005149000 iter:450 epoch:1 loss:0.426095
0x7000051cc000 iter:460 epoch:1 loss:0.365458
0x700005149000 iter:470 epoch:1 loss:0.356759
0x7000051cc000 iter:480 epoch:1 loss:0.437114
0x700005149000 iter:490 epoch:1 loss:0.494906
0x7000051cc000 iter:500 epoch:1 loss:0.489826
0x7000050c6000 iter:510 epoch:1 loss:0.404909
0x7000051cc000 val_accuracy:0.948
0x7000050c6000 iter:520 epoch:1 loss:0.353771
0x7000051cc000 iter:530 epoch:1 loss:0.444719
0x7000050c6000 iter:540 epoch:1 loss:0.389457
0x7000051cc000 iter:550 epoch:1 loss:0.480927
0x7000050c6000 iter:560 epoch:1 loss:0.38697
0x7000051cc000 iter:570 epoch:1 loss:0.409872
0x7000050c6000 iter:580 epoch:1 loss:0.483502
0x7000051cc000 iter:590 epoch:1 loss:0.329717
0x7000050c6000 iter:600 epoch:1 loss:0.45138
0x700005149000 iter:610 epoch:2 loss:0.390348
0x7000050c6000 val_accuracy:0.955
0x7000051cc000 iter:620 epoch:2 loss:0.45438
0x700005043000 iter:630 epoch:2 loss:0.326586
0x7000051cc000 iter:640 epoch:2 loss:0.388888
0x700005043000 iter:650 epoch:2 loss:0.341562
0x7000051cc000 iter:660 epoch:2 loss:0.506668
0x700005043000 iter:670 epoch:2 loss:0.431818
0x7000051cc000 iter:680 epoch:2 loss:0.370288
0x7000050c6000 iter:690 epoch:2 loss:0.466906
0x700005149000 iter:700 epoch:2 loss:0.492355
0x7000051cc000 iter:710 epoch:2 loss:0.400121
0x700005149000 val_accuracy:0.951
0x7000051cc000 iter:720 epoch:2 loss:0.354867
0x700005043000 iter:730 epoch:2 loss:0.342793
0x7000051cc000 iter:740 epoch:2 loss:0.410007
0x700005043000 iter:750 epoch:2 loss:0.378259
0x7000051cc000 iter:760 epoch:2 loss:0.292614
0x700005043000 iter:770 epoch:2 loss:0.372086
0x7000051cc000 iter:780 epoch:2 loss:0.375274
0x700005043000 iter:790 epoch:2 loss:0.344944
0x7000051cc000 iter:800 epoch:2 loss:0.394684
0x7000050c6000 iter:810 epoch:2 loss:0.488805
0x7000051cc000 val_accuracy:0.959
0x7000050c6000 iter:820 epoch:2 loss:0.498478
0x7000051cc000 iter:830 epoch:2 loss:0.388287
0x7000050c6000 iter:840 epoch:2 loss:0.46984
0x7000051cc000 iter:850 epoch:2 loss:0.342379
0x7000050c6000 iter:860 epoch:2 loss:0.470386
0x700005149000 iter:870 epoch:2 loss:0.412072
0x7000050c6000 iter:880 epoch:2 loss:0.39561
0x700005149000 iter:890 epoch:2 loss:0.401787
0x7000050c6000 iter:900 epoch:2 loss:0.33502
0x700005043000 iter:910 epoch:2 loss:0.379394
0x7000050c6000 val_accuracy:0.961
0x700005043000 iter:920 epoch:2 loss:0.400432
0x700005149000 iter:930 epoch:2 loss:0.372334
0x700005043000 iter:940 epoch:2 loss:0.454128
0x700005149000 iter:950 epoch:2 loss:0.331954
0x700005043000 iter:960 epoch:2 loss:0.406657
0x700005149000 iter:970 epoch:2 loss:0.371481
0x700005043000 iter:980 epoch:2 loss:0.366581
0x7000050c6000 iter:990 epoch:2 loss:0.417349
0x700005043000 iter:1000 epoch:2 loss:0.469582
0x7000051cc000 iter:1010 epoch:2 loss:0.451378
0x700005043000 val_accuracy:0.956
0x7000051cc000 iter:1020 epoch:2 loss:0.385707
0x700005149000 iter:1030 epoch:2 loss:0.430333
0x7000051cc000 iter:1040 epoch:2 loss:0.373176
0x700005149000 iter:1050 epoch:2 loss:0.379118
0x7000051cc000 iter:1060 epoch:2 loss:0.464486
0x700005149000 iter:1070 epoch:2 loss:0.443292
0x7000051cc000 iter:1080 epoch:2 loss:0.311709
0x700005149000 iter:1090 epoch:2 loss:0.493245
0x7000051cc000 iter:1100 epoch:2 loss:0.307571
0x7000050c6000 iter:1110 epoch:2 loss:0.43209
0x7000051cc000 val_accuracy:0.955
0x7000050c6000 iter:1120 epoch:2 loss:0.32757
0x700005043000 iter:1130 epoch:2 loss:0.436366
0x7000050c6000 iter:1140 epoch:2 loss:0.421496
0x700005043000 iter:1150 epoch:2 loss:0.40594
0x7000050c6000 iter:1160 epoch:2 loss:0.374986
0x7000051cc000 iter:1170 epoch:2 loss:0.424207
0x7000050c6000 iter:1180 epoch:2 loss:0.410098
0x700005043000 iter:1190 epoch:2 loss:0.368829
0x700005043000 iter:1200 epoch:2 loss:0.355898
final val accuracy:0.957 loss:0.327614
0x700005043000 val_accuracy:0.956
final val accuracy:0.965 loss:0.414997
final val accuracy:0.965 loss:0.322277
final val accuracy:0.964 loss:0.348698
final test accuracy 0.9621
